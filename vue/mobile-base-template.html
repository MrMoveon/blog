<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建一个vue-cli4+webpack+vue2.0移动端框架 | 前端开发笔记</title>
    <meta name="description" content="前端开发笔记">
    <link rel="icon" href="/blog/icon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.45e5a3ae.css" as="style"><link rel="preload" href="/blog/assets/js/app.ee223f02.js" as="script"><link rel="preload" href="/blog/assets/js/2.f364336e.js" as="script"><link rel="preload" href="/blog/assets/js/14.25b3510a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.60d9a5c4.js"><link rel="prefetch" href="/blog/assets/js/11.9d12addb.js"><link rel="prefetch" href="/blog/assets/js/12.8ef0bd8a.js"><link rel="prefetch" href="/blog/assets/js/13.71ffc42f.js"><link rel="prefetch" href="/blog/assets/js/15.c4d91af5.js"><link rel="prefetch" href="/blog/assets/js/16.948c6a33.js"><link rel="prefetch" href="/blog/assets/js/17.0e6c3b39.js"><link rel="prefetch" href="/blog/assets/js/18.5f7af77b.js"><link rel="prefetch" href="/blog/assets/js/19.3d23eaff.js"><link rel="prefetch" href="/blog/assets/js/20.472050f8.js"><link rel="prefetch" href="/blog/assets/js/21.daaff1eb.js"><link rel="prefetch" href="/blog/assets/js/22.ae3ff2ee.js"><link rel="prefetch" href="/blog/assets/js/23.06d58a4e.js"><link rel="prefetch" href="/blog/assets/js/24.8df026f6.js"><link rel="prefetch" href="/blog/assets/js/25.8fa3c5ac.js"><link rel="prefetch" href="/blog/assets/js/26.b9e79cc9.js"><link rel="prefetch" href="/blog/assets/js/27.0c29d378.js"><link rel="prefetch" href="/blog/assets/js/28.5c6b388b.js"><link rel="prefetch" href="/blog/assets/js/29.a0f69e48.js"><link rel="prefetch" href="/blog/assets/js/3.641e1028.js"><link rel="prefetch" href="/blog/assets/js/30.dc7fbcb3.js"><link rel="prefetch" href="/blog/assets/js/31.a0f54c32.js"><link rel="prefetch" href="/blog/assets/js/32.06b2a848.js"><link rel="prefetch" href="/blog/assets/js/33.1707ffb1.js"><link rel="prefetch" href="/blog/assets/js/34.4a894dbb.js"><link rel="prefetch" href="/blog/assets/js/35.380e3cca.js"><link rel="prefetch" href="/blog/assets/js/36.cbda8a08.js"><link rel="prefetch" href="/blog/assets/js/37.a4ee9d32.js"><link rel="prefetch" href="/blog/assets/js/38.9d939308.js"><link rel="prefetch" href="/blog/assets/js/39.0db069f8.js"><link rel="prefetch" href="/blog/assets/js/4.dd025489.js"><link rel="prefetch" href="/blog/assets/js/40.7207834f.js"><link rel="prefetch" href="/blog/assets/js/41.a0452c50.js"><link rel="prefetch" href="/blog/assets/js/42.2122454f.js"><link rel="prefetch" href="/blog/assets/js/43.8bb0a71b.js"><link rel="prefetch" href="/blog/assets/js/44.3e769886.js"><link rel="prefetch" href="/blog/assets/js/5.2cc523f9.js"><link rel="prefetch" href="/blog/assets/js/6.86e346f0.js"><link rel="prefetch" href="/blog/assets/js/7.d17b9335.js"><link rel="prefetch" href="/blog/assets/js/8.b2177cb3.js"><link rel="prefetch" href="/blog/assets/js/9.a8aca7d1.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.45e5a3ae.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">前端开发笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/framework/jquery/" class="nav-link">jquery源码分析</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/" class="nav-link router-link-active">vue最佳实践</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/mobile-base-template.html" class="nav-link router-link-exact-active router-link-active">vue移动端模版</a></li><li class="dropdown-item"><!----> <a href="/blog/typescript/" class="nav-link">typescript</a></li><li class="dropdown-item"><!----> <a href="/blog/mina/" class="nav-link">微信小程序</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tools/dd-utils.html" class="nav-link">自定义工具函数库</a></li><li class="dropdown-item"><!----> <a href="/blog/vscode-plugins/" class="nav-link">vscode常用插件</a></li><li class="dropdown-item"><!----> <a href="/blog/vuepress/" class="nav-link">vuepress</a></li><li class="dropdown-item"><!----> <a href="/blog/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/blog/mock/" class="nav-link">mock</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/" class="nav-link">工具函數</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/date.html" class="nav-link">日期函數</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mongoDB/" class="nav-link">mongoDB学习</a></li><li class="dropdown-item"><!----> <a href="/blog/mongoDB/learning/aggregate.html" class="nav-link">mongoDB aggregate</a></li><li class="dropdown-item"><!----> <a href="/blog/mongoDB/learning/mongoose.html" class="nav-link">mongoose</a></li><li class="dropdown-item"><!----> <a href="/blog/Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">可视化</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/svg-canvas/svg.html" class="nav-link">svg</a></li><li class="dropdown-item"><!----> <a href="/blog/svg-canvas/canvas.html" class="nav-link">canvas</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">electron</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/electron/" class="nav-link">electron 基础</a></li><li class="dropdown-item"><!----> <a href="/blog/electron/meos.html" class="nav-link">electron 进阶</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">egg</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/egg/" class="nav-link">egg最佳实践</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask.html" class="nav-link">egg ask项目后端</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask-client.html" class="nav-link">egg ask项目前端</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask-client.html" class="nav-link">egg ask项目管理平台</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">uniapp</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/uniapp/xiaomi.html" class="nav-link">项目实战-xiaomi</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/scaffold/" class="nav-link">手撸一个前端脚手架</a></li><li class="dropdown-item"><!----> <a href="/blog/gulp_multi_pages/" class="nav-link">gulp多页面应用脚手架</a></li><li class="dropdown-item"><!----> <a href="/blog/regexp/" class="nav-link">正则学习</a></li><li class="dropdown-item"><!----> <a href="/blog/webapp/" class="nav-link">webapp</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrMoveon/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/framework/jquery/" class="nav-link">jquery源码分析</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/" class="nav-link router-link-active">vue最佳实践</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/mobile-base-template.html" class="nav-link router-link-exact-active router-link-active">vue移动端模版</a></li><li class="dropdown-item"><!----> <a href="/blog/typescript/" class="nav-link">typescript</a></li><li class="dropdown-item"><!----> <a href="/blog/mina/" class="nav-link">微信小程序</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tools/dd-utils.html" class="nav-link">自定义工具函数库</a></li><li class="dropdown-item"><!----> <a href="/blog/vscode-plugins/" class="nav-link">vscode常用插件</a></li><li class="dropdown-item"><!----> <a href="/blog/vuepress/" class="nav-link">vuepress</a></li><li class="dropdown-item"><!----> <a href="/blog/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/blog/mock/" class="nav-link">mock</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/" class="nav-link">工具函數</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/date.html" class="nav-link">日期函數</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mongoDB/" class="nav-link">mongoDB学习</a></li><li class="dropdown-item"><!----> <a href="/blog/mongoDB/learning/aggregate.html" class="nav-link">mongoDB aggregate</a></li><li class="dropdown-item"><!----> <a href="/blog/mongoDB/learning/mongoose.html" class="nav-link">mongoose</a></li><li class="dropdown-item"><!----> <a href="/blog/Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">可视化</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/svg-canvas/svg.html" class="nav-link">svg</a></li><li class="dropdown-item"><!----> <a href="/blog/svg-canvas/canvas.html" class="nav-link">canvas</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">electron</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/electron/" class="nav-link">electron 基础</a></li><li class="dropdown-item"><!----> <a href="/blog/electron/meos.html" class="nav-link">electron 进阶</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">egg</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/egg/" class="nav-link">egg最佳实践</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask.html" class="nav-link">egg ask项目后端</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask-client.html" class="nav-link">egg ask项目前端</a></li><li class="dropdown-item"><!----> <a href="/blog/egg/ask-client.html" class="nav-link">egg ask项目管理平台</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">uniapp</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/uniapp/xiaomi.html" class="nav-link">项目实战-xiaomi</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/scaffold/" class="nav-link">手撸一个前端脚手架</a></li><li class="dropdown-item"><!----> <a href="/blog/gulp_multi_pages/" class="nav-link">gulp多页面应用脚手架</a></li><li class="dropdown-item"><!----> <a href="/blog/regexp/" class="nav-link">正则学习</a></li><li class="dropdown-item"><!----> <a href="/blog/webapp/" class="nav-link">webapp</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrMoveon/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>搭建一个vue-cli4+webpack+vue2.0移动端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/mobile-base-template.html#创建项目" class="sidebar-link">创建项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#目录结构" class="sidebar-link">目录结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#开发环境配置" class="sidebar-link">开发环境配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#eslint-pettier-统一开发规范" class="sidebar-link">Eslint+Pettier 统一开发规范</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#配置-alias-别名" class="sidebar-link">配置 alias 别名</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#配置路径提示及代码智提" class="sidebar-link">配置路径提示及代码智提</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#配置-proxy-跨域" class="sidebar-link">配置 proxy 跨域</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#多环境变量配置" class="sidebar-link">多环境变量配置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#css预处理器" class="sidebar-link">css预处理器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#scss全局样式配置" class="sidebar-link">scss全局样式配置</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#scss-variables" class="sidebar-link">scss variables</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#scss-常用mixin" class="sidebar-link">scss 常用mixin</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#less配置" class="sidebar-link">less配置</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#配置vant" class="sidebar-link">配置vant</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#引入vant" class="sidebar-link">引入vant</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#按需加载" class="sidebar-link">按需加载</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#rem-布局适配" class="sidebar-link">Rem 布局适配</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#postcss-配置" class="sidebar-link">PostCSS 配置</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#vant安全区适配" class="sidebar-link">vant安全区适配</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#自己写安全区适配" class="sidebar-link">自己写安全区适配</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#暗黑模式" class="sidebar-link">暗黑模式</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#vuex-状态管理" class="sidebar-link">Vuex 状态管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#模块" class="sidebar-link">模块</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#使用常量替代mutation类型" class="sidebar-link">使用常量替代Mutation类型</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#命名空间" class="sidebar-link">命名空间</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#数据缓存" class="sidebar-link">数据缓存</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#vuerouter设置" class="sidebar-link">VueRouter设置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#记录tabbar浏览的位置" class="sidebar-link">记录tabbar浏览的位置</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#配置-externals-引入-cdn-资源" class="sidebar-link">配置 externals 引入 cdn 资源</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#去掉console-log" class="sidebar-link">去掉console.log</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#gzip压缩" class="sidebar-link">Gzip压缩</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#webpack-可视化分析" class="sidebar-link">webpack 可视化分析</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/vue/mobile-base-template.html#首页添加骨架屏" class="sidebar-link">首页添加骨架屏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#puppeteer安装问题" class="sidebar-link">Puppeteer安装问题</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#常用工具函数" class="sidebar-link">常用工具函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#echarts适配" class="sidebar-link">echarts适配</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#截取字符串并加省略号" class="sidebar-link">截取字符串并加省略号</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#数组数字去重" class="sidebar-link">数组数字去重</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#日期格式替换" class="sidebar-link">日期格式替换</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#延迟执行" class="sidebar-link">延迟执行</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#冒泡排序" class="sidebar-link">冒泡排序</a></li><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#设备颜色模式" class="sidebar-link">设备颜色模式</a></li></ul></li><li><a href="/blog/vue/mobile-base-template.html#开发遇到的问题" class="sidebar-link">开发遇到的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/mobile-base-template.html#echarts" class="sidebar-link">echarts</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="搭建一个vue-cli4-webpack-vue2-0移动端框架"><a href="#搭建一个vue-cli4-webpack-vue2-0移动端框架" aria-hidden="true" class="header-anchor">#</a> 搭建一个vue-cli4+webpack+vue2.0移动端框架</h1> <p>这是基于 vue-cli4 实现的移动端框架，其中包含项目常用的配置，组件封装及webpack优化方法，可供快速开发使用。</p> <p>技术栈：vue-cli4 + webpack4 + vant + axios + scss + postcss-pxtorem</p> <h2 id="创建项目"><a href="#创建项目" aria-hidden="true" class="header-anchor">#</a> 创建项目</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>vue create vue-mobile

<span class="token comment">#选择用户自定义</span>
Please pick a preset

Manually <span class="token keyword">select</span> features

<span class="token comment">#选择需要的插件</span>
Check the features needed <span class="token keyword">for</span> your project:

 <span class="token punctuation">(</span>*<span class="token punctuation">)</span> Choose Vue version
 <span class="token punctuation">(</span>*<span class="token punctuation">)</span> Babel
 <span class="token punctuation">(</span> <span class="token punctuation">)</span> TypeScript
 <span class="token punctuation">(</span> <span class="token punctuation">)</span> Progressive Web App <span class="token punctuation">(</span>PWA<span class="token punctuation">)</span> Support
 <span class="token punctuation">(</span>*<span class="token punctuation">)</span> Router
 <span class="token punctuation">(</span>*<span class="token punctuation">)</span> Vuex
<span class="token operator">&gt;</span><span class="token punctuation">(</span>*<span class="token punctuation">)</span> CSS Pre-processors
 <span class="token punctuation">(</span>*<span class="token punctuation">)</span> Linter / Formatter
 <span class="token punctuation">(</span> <span class="token punctuation">)</span> Unit Testing
 <span class="token punctuation">(</span> <span class="token punctuation">)</span> E2E Testing

Choose a version of Vue.js that you want to start the project with <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token number">2</span>.x

<span class="token comment"># 是否使用history路由</span>
Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? No

<span class="token comment"># 选择css预处理器</span>
Pick a CSS pre-processor
<span class="token operator">&gt;</span> Sass/SCSS <span class="token punctuation">(</span>with dart-sass<span class="token punctuation">)</span>
  Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
  Less
  Stylus
  
<span class="token comment"># 选择eslint格式配置</span>
 Pick a linter / formatter config:
 ESLint + Prettier
</code></pre></div><h2 id="目录结构"><a href="#目录结构" aria-hidden="true" class="header-anchor">#</a> 目录结构</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>vue-mobile
├── babel.config.js
├── dist								<span class="token comment"># 打包后，生成的文件目录</span>
├── jsconfig.json						<span class="token comment"># 项目引用的路径别名设置</span>
├── package-lock.json
├── package.json
├── public
│   ├── favicon.ico
│   ├── index.html						<span class="token comment"># 模版文件</span>
│   └── static							<span class="token comment"># 静态资源</span>
│       └── js
│           └── flexible.js
├── README.md
├── shell								<span class="token comment"># 骨架屏生成的文件</span>
│   └── index.html
├── src
│   ├── api								<span class="token comment"># 接口目录</span>
│   │   └── user.js
│   ├── App.vue
│   ├── assets							<span class="token comment"># 资源目录</span>
│   │   ├── css							<span class="token comment"># css</span>
│   │   │   ├── app.scss				<span class="token comment"># 应用scss</span>
│   │   │   ├── mixins.scss				<span class="token comment"># 全局混合</span>
│   │   │   └── variables.scss			<span class="token comment"># 全局变量</span>
│   │   └── logo.png
│   ├── components						<span class="token comment"># 组件</span>
│   ├── config							<span class="token comment"># 配置文件</span>
│   │   ├── env.base.js					<span class="token comment"># 基础配置</span>
│   │   ├── env.development.js			<span class="token comment"># 开发配置</span>
│   │   ├── env.production.js			<span class="token comment"># 生产配置</span>
│   │   ├── env.skeleton.js				<span class="token comment"># 骨架屏配置</span>
│   │   ├── env.staging.js				<span class="token comment"># 测试配置</span>
│   │   └── index.js
│   ├── libs							<span class="token comment"># 第三方库</span>
│   │   ├── api.request.js				<span class="token comment"># 封装axios</span>
│   │   ├── axios.js					<span class="token comment"># 封装axios</span>
│   │   ├── errorHandle.js				<span class="token comment"># axios 错误处理</span>
│   │   ├── storage.js					<span class="token comment"># localstorage 缓存处理</span>
│   │   └── utils.js					<span class="token comment"># 工具方法</span>
│   ├── main.js
│   ├── plugins							<span class="token comment"># 插件</span>
│   │   ├── index.js					<span class="token comment"># 引入其他第三方插件，echarts,dayjs等等</span>
│   │   └── vant.js						<span class="token comment"># 引入vant ui 库</span>
│   ├── router							<span class="token comment"># 路由</span>
│   │   └── index.js
│   ├── store							<span class="token comment"># vuex</span>
│   │   ├── index.js
│   │   ├── modules						<span class="token comment"># 划分模块</span>
│   │   │   └── app.js					<span class="token comment"># app全局状态</span>
│   │   └── mutation-types.js			<span class="token comment"># mutation 类型文件</span>
│   └── views							<span class="token comment"># 界面</span>
│       ├── About.vue
│       └── Home.vue
└── vue.config.js						<span class="token comment"># 其他vue项目配置</span>

</code></pre></div><h2 id="开发环境配置"><a href="#开发环境配置" aria-hidden="true" class="header-anchor">#</a> 开发环境配置</h2> <h3 id="eslint-pettier-统一开发规范"><a href="#eslint-pettier-统一开发规范" aria-hidden="true" class="header-anchor">#</a> Eslint+Pettier 统一开发规范</h3> <p>为了编辑器和eslint的自动保存格式化一致，在项目根目录创建.prettierrc，统一格式化为单引号，无分号等</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;printWidth&quot;</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tabWidth&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;singleQuote&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;trailingComma&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;semi&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;wrap_line_length&quot;</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
  <span class="token property">&quot;wrap_attributes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;proseWrap&quot;</span><span class="token operator">:</span> <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;arrowParens&quot;</span><span class="token operator">:</span> <span class="token string">&quot;avoid&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bracketSpacing&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;jsxBracketSameLine&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;useTabs&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;overrides&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.prettierrc&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;json&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><ul><li>printWidth： 控制单行最大长度</li> <li>semi： 控制每条语句是否加上分号</li> <li>tabWidth： 控制一个tab对应的空格数</li> <li>useTabs： 控制缩进用tab还是space</li> <li>singleQuote：控制字符串是用单引号还是双引号</li> <li>trailingComma： 是否去掉末尾的逗号</li> <li>bracketSpacing： 控制json对象括号前后是否加上空格</li></ul></blockquote> <h3 id="配置-alias-别名"><a href="#配置-alias-别名" aria-hidden="true" class="header-anchor">#</a> 配置 alias 别名</h3> <p>為了让引入组件更加方便，有时需要在<code>vue.config.js</code>配置别名。</p> <div class="language-js extra-class"><pre class="language-js"><code>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span>
  <span class="token comment">// 对内部的 webpack 配置进行修改</span>
  <span class="token function-variable function">chainWebpack</span><span class="token punctuation">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置路径解析別名</span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias
      <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'_c'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/api'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/config'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'libs'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/libs'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="配置路径提示及代码智提"><a href="#配置路径提示及代码智提" aria-hidden="true" class="header-anchor">#</a> 配置路径提示及代码智提</h3> <p>1、安装插件：Path Intellisense
2、文件-&gt;首选项-&gt;设置-&gt;搜索Path Intellisense-&gt;工作区-&gt;在settings.json中编辑Mappings</p> <p>配置用户配置的插件指向路徑：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;path-intellisense.mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceRoot}/src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_c&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceRoot}/src/components&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceRoot}/src/api&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceRoot}/src/config&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;libs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceRoot}/src/libs&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>3、 在项目package.json所在同级目录下创建文件jsconfig.json：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;allowSyntheticDefaultImports&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;_c/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/components/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;api/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/api/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;config/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/config/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;libs/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/libs/*&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><p>4、重启编辑器生效</p> <h3 id="配置-proxy-跨域"><a href="#配置-proxy-跨域" aria-hidden="true" class="header-anchor">#</a> 配置 proxy 跨域</h3> <p>在<code>vue.config.js</code>进行配置proxy</p> <div class="language-js extra-class"><pre class="language-js"><code>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    port<span class="token punctuation">:</span> myConfig<span class="token punctuation">.</span>port <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">,</span> <span class="token comment">// 端口号</span>
    open<span class="token punctuation">:</span> myConfig<span class="token punctuation">.</span>open <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 自动打开浏览器</span>
    proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">'https://test.xxx.com'</span><span class="token punctuation">,</span> <span class="token comment">// 接口的域名</span>
        <span class="token comment">// ws: true, // 是否启用websockets</span>
        changOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启代理，在本地创建一个虚拟服务端</span>
        pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">'^/api'</span><span class="token punctuation">:</span> <span class="token string">'/'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="多环境变量配置"><a href="#多环境变量配置" aria-hidden="true" class="header-anchor">#</a> 多环境变量配置</h2> <p>首先我们先来了解一下环境变量，一般情况下我们的项目会有三个环境，本地环境(development)，测试环境(test)，生产环境(production)，我们可以在项目根目录下建三个配置环境变量的文件<code>.env.development</code>，<code>.env.test</code>，<code>.env.production</code></p> <p>环境变量文件中只包含环境变量的“键=值”对：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span>
<span class="token constant">VUE_APP_ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span> <span class="token comment">// 只有VUE_APP开头的环境变量可以在项目代码中直接使用</span>
</code></pre></div><p>除了自定义的 VUE*APP**变量之外，还有两个可用的变量：</p> <ul><li>NODE_ENV : &quot;development&quot;、&quot;production&quot; 或 &quot;test&quot;中的一个。具体的值取决于应用运行的模式。</li> <li>BASE_URL : 和 vue.config.js 中的 publicPath 选项相符，即你的应用会部署到的基础路径。</li></ul> <p><code>package.json</code> 里的 <code>scripts</code> 配置 <code>serve</code> <code>stage</code> <code>build</code>，通过 <code>--mode xxx</code> 来执行不同环境</p> <ul><li>通过 <code>npm run serve</code> 启动本地 , 执行 <code>development</code></li> <li>通过 <code>npm run stage</code> 打包测试 , 执行 <code>staging</code></li> <li>通过 <code>npm run build</code> 打包正式 , 执行 <code>production</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code> &quot;scripts&quot;: {
    &quot;serve&quot;: &quot;vue-cli-service serve&quot;,
    &quot;build&quot;: &quot;vue-cli-service build&quot;,
    &quot;stage&quot;: &quot;vue-cli-service build --mode staging&quot;,
    &quot;lint&quot;: &quot;vue-cli-service lint&quot;
  },
</code></pre></div><p>下面开始配置我们的环境变量</p> <p>1、在项目根目录中新建.env.*</p> <ul><li>.env.development 本地开发环境配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span><span class="token string">'development'</span>
<span class="token constant">VUE_APP_ENV</span> <span class="token operator">=</span> <span class="token string">'development'</span>
</code></pre></div><ul><li>env.staging 测试环境配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span><span class="token string">'production'</span>
<span class="token constant">VUE_APP_ENV</span> <span class="token operator">=</span> <span class="token string">'staging'</span>
</code></pre></div><ul><li>env.production 正式环境配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span><span class="token string">'production'</span>
<span class="token constant">VUE_APP_ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span>
</code></pre></div><p>这里我们并没有定义很多变量，只定义了基础的 VUE_APP_ENV <code>development</code> <code>staging</code> <code>production</code>
变量我们统一在 <code>src/config/env.*.js</code> 里进行管理。</p> <p>这里有个问题，既然这里有了根据不同环境设置变量的文件，为什么还要去 config 下新建三个对应的文件呢？
<strong>修改起来方便，不需 要重启项目，符合开发习惯。</strong></p> <p>我们在 src 文件下新建一个 config/index</p> <div class="language- extra-class"><pre class="language-text"><code>// 公共配置
const base = require('./env.base')
// 根据环境引入不同配置 process.env.NODE_ENV
const envConfig = require('./env.' + process.env.VUE_APP_ENV)
// 合并配置
const config = Object.assign({}, base, envConfig)
module.exports = config

</code></pre></div><p>在同级目录下新建<code>env.base.js</code>， <code>env.development.js</code>，<code>env.staging.js</code>，<code>env.production.js</code>，在里面配置需要的变量。
以 <code>env.base.js</code>, <code>env.development.js</code> 为例</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 应用标题
   */</span>
  appTitle<span class="token punctuation">:</span> <span class="token string">'vue2.0移动端模版'</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>module.exports = {
  /**
   * 应用标题
   */
  appTitle: 'vue2.0移动端模版-开发模式'
}

</code></pre></div><p><code>env.base.js</code>写入应用的常用配置，其他配置文件就行合并修改。</p> <p>在<code>vue.config.js</code>进行网页标题配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入配置文件</span>
<span class="token keyword">const</span> myConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/config/index'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span>
  <span class="token comment">// 对内部的 webpack 配置进行修改</span>
  <span class="token function-variable function">chainWebpack</span><span class="token punctuation">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 修改网页标题</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">args</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">=</span> myConfig<span class="token punctuation">.</span>appTitle
      <span class="token keyword">return</span> args
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><p>重启应用，我们发下浏览器上标签网页标题已经变化！</p> <p><img src="data:image/png;base64,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" alt="image"></p> <h2 id="css预处理器"><a href="#css预处理器" aria-hidden="true" class="header-anchor">#</a> css预处理器</h2> <h3 id="scss全局样式配置"><a href="#scss全局样式配置" aria-hidden="true" class="header-anchor">#</a> scss全局样式配置</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Sass 安装</span>
<span class="token function">npm</span> <span class="token function">install</span> -D sass-loader sass
</code></pre></div><p>目录结构，在 <code>src/assets/css/</code>文件夹下包含了三个文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code>├── assets
│   ├── css
│   │   ├── app.scss                 <span class="token comment"># 全局通用样式</span>
│   │   ├── mixin.scss               <span class="token comment"># 全局mixin</span>
│   │   └── variables.scss           <span class="token comment"># 全局变量</span>
</code></pre></div><p><code>vue.config.js</code> 配置注入 <code>sass</code> 的 <code>mixin</code> <code>variables</code> 到全局，不需要手动引入 ,配置<code>$cdn</code>通过变量形式引入 cdn 地址</p> <div class="language- extra-class"><pre class="language-text"><code>// 引入配置文件
const myConfig = require('./src/config/index')

module.exports = {
  ...
  css: {
    ...
      scss: {
        //全局变量注入，多个用;分割
        prependData: `
          @import &quot;~@/assets/css/variables.scss&quot;;
          @import &quot;~@/assets/css/mixins.scss&quot;;
          $cdn:&quot;${myConfig.$cdn}&quot;;
        `
      },
     ...
    }
  }
}

</code></pre></div><p><code>env.base.js</code> 增加 $cdn变量</p> <div class="language- extra-class"><pre class="language-text"><code>module.exports = {
  /**
   * $cdn 资源地址
   */
  $cdn: 'https://cdn.jsdelivr.net'
}

</code></pre></div><p><code>main.js</code> 引入全局app.scss，并引入$cdn，挂载到vue上</p> <div class="language- extra-class"><pre class="language-text"><code>...
// 引入全局样式
import '@/assets/css/app.scss'
// 设置 js中可以访问 $cdn
// 引入cdn
import { $cdn } from '@/config'
Vue.prototype.$cdn = $cdn
...

</code></pre></div><p>这样就可以在scss以及script中使用$cdn 访问变量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cdn'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$cdn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;scss&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>home <span class="token punctuation">{</span>
  background<span class="token punctuation">:</span> $main<span class="token operator">-</span>color<span class="token punctuation">;</span>
  <span class="token operator">&amp;</span><span class="token punctuation">:</span>after <span class="token punctuation">{</span>
    content<span class="token punctuation">:</span> $cdn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre></div><h3 id="scss-variables"><a href="#scss-variables" aria-hidden="true" class="header-anchor">#</a> scss variables</h3> <div class="language- extra-class"><pre class="language-text"><code>/**
* BEM配置
*/
$namespace: &quot;m&quot;;
$elementSeparator: &quot;__&quot;;
$modifierSeparator: &quot;--&quot;;
</code></pre></div><h3 id="scss-常用mixin"><a href="#scss-常用mixin" aria-hidden="true" class="header-anchor">#</a> scss 常用mixin</h3> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">/**
* 文本居中
* @param {String} 高度
* @example @include  text-center(50px)
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">text-center</span><span class="token punctuation">(</span><span class="token variable">$height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token variable">$height</span><span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token variable">$height</span><span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 文本不换行
* @example @include no-wrap()
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
    <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 溢出省略号
* @param {Number} 行数
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">ellipsis</span><span class="token punctuation">(</span><span class="token property"><span class="token variable">$rowCount</span></span><span class="token punctuation">:</span> 1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">@if</span> <span class="token selector"><span class="token variable">$rowCount</span> &lt;=1 </span><span class="token punctuation">{</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
        <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
        <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">@else</span> <span class="token punctuation">{</span>
        <span class="token property">min-width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
        <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
        <span class="token property">-webkit-line-clamp</span><span class="token punctuation">:</span> <span class="token variable">$rowCount</span><span class="token punctuation">;</span>
        <span class="token property">-webkit-box-orient</span><span class="token punctuation">:</span> vertical<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 清除浮动
* @example @include clearfix()
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">clearfix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token selector"><span class="token parent important">&amp;</span>:before,
    <span class="token parent important">&amp;</span>:after </span><span class="token punctuation">{</span>
        <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token parent important">&amp;</span>:after </span><span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 等边三角形
* @param {String} 尺寸
* @param {Color} 颜色
* @param {String} 方向
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">triangle</span><span class="token punctuation">(</span><span class="token property"><span class="token variable">$size</span></span><span class="token punctuation">:</span> 5px<span class="token punctuation">,</span> <span class="token property"><span class="token variable">$color</span></span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.6<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token property"><span class="token variable">$dir</span></span><span class="token punctuation">:</span> bottom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">border-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>

    <span class="token keyword">@if</span> <span class="token punctuation">(</span>bottom==<span class="token variable">$dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token property">border-width</span><span class="token punctuation">:</span> <span class="token variable">$size</span> <span class="token variable">$size</span> 0 <span class="token variable">$size</span><span class="token punctuation">;</span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token variable">$color</span> transparent transparent transparent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">@else if</span> <span class="token punctuation">(</span>top==<span class="token variable">$dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token property">border-width</span><span class="token punctuation">:</span> 0 <span class="token variable">$size</span> <span class="token variable">$size</span> <span class="token variable">$size</span><span class="token punctuation">;</span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> transparent transparent <span class="token variable">$color</span> transparent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">@else if</span> <span class="token punctuation">(</span>right==<span class="token variable">$dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token property">border-width</span><span class="token punctuation">:</span> <span class="token variable">$size</span> 0 <span class="token variable">$size</span> <span class="token variable">$size</span><span class="token punctuation">;</span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> transparent transparent transparent <span class="token variable">$color</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">@else if</span> <span class="token punctuation">(</span>left==<span class="token variable">$dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token property">border-width</span><span class="token punctuation">:</span> <span class="token variable">$size</span> <span class="token variable">$size</span> <span class="token variable">$size</span> 0<span class="token punctuation">;</span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> transparent <span class="token variable">$color</span> transparent transparent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* BEM
* @param $block 模块
* @param $element 元素
* @param $modifier 修饰
*/</span>

<span class="token keyword">@mixin</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token variable">$block</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property"><span class="token variable">$B</span></span><span class="token punctuation">:</span> <span class="token variable">$namespace</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token variable">$block</span><span class="token punctuation">;</span>
    <span class="token selector">.<span class="token variable">#{$B}</span> </span><span class="token punctuation">{</span>
        <span class="token keyword">@content</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">@mixin</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property"><span class="token variable">$selector</span></span><span class="token punctuation">:</span> &amp;<span class="token punctuation">;</span>
    <span class="token atrule"><span class="token rule">@at-root</span></span> <span class="token punctuation">{</span>
        #<span class="token punctuation">{</span><span class="token variable">$selector</span> <span class="token operator">+</span> <span class="token variable">$elementSeparator</span> <span class="token operator">+</span> <span class="token variable">$element</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
            <span class="token keyword">@content</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">@mixin</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token variable">$modifier</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property"><span class="token variable">$selector</span></span><span class="token punctuation">:</span> &amp;<span class="token punctuation">;</span>
    <span class="token atrule"><span class="token rule">@at-root</span></span> <span class="token punctuation">{</span>
        #<span class="token punctuation">{</span><span class="token variable">$selector</span> <span class="token operator">+</span> <span class="token variable">$modifierSeparator</span> <span class="token operator">+</span> <span class="token variable">$modifier</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
            <span class="token keyword">@content</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* safe-area 安全区域的混合
* @param $class 类名
* @param $dir 方向 left top bottom right
* @param $value 距离边距的值
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">safe-area</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">,</span> <span class="token property"><span class="token variable">$dir</span></span><span class="token punctuation">:</span> <span class="token string">&quot;bottom&quot;</span><span class="token punctuation">,</span> <span class="token property"><span class="token variable">$value</span></span><span class="token punctuation">:</span> 24px<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token atrule"><span class="token rule">@at-root</span></span> <span class="token punctuation">{</span>
        @supports <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token selector"><span class="token variable">#{$class}</span> </span><span class="token punctuation">{</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token variable">#{$value}</span> <span class="token operator">+</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token variable">#{$value}</span> <span class="token operator">+</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>BEM使用：</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token keyword">@include</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #eee<span class="token punctuation">;</span>
  <span class="token keyword">@include</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token string">'item'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
    <span class="token keyword">@include</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 生成：</span>
<span class="token selector">.m-list </span><span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 0.02667rem solid #eee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.m-list__item </span><span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0.26667rem<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.m-list__item--red </span><span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="less配置"><a href="#less配置" aria-hidden="true" class="header-anchor">#</a> less配置</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Less</span>
<span class="token function">npm</span> <span class="token function">install</span> -D less-loader <span class="token function">less</span>
</code></pre></div><p>处理less引入报错：</p> <div class="language- extra-class"><pre class="language-text"><code>css: {
    // css预设器配置项
    loaderOptions: {
      ...
      less: {
        lessOptions: {
          javascriptEnabled: true
        }
      }
    }
  }
</code></pre></div><h2 id="配置vant"><a href="#配置vant" aria-hidden="true" class="header-anchor">#</a> 配置vant</h2> <p>Vant 是<strong>有赞前端团队</strong>开源的移动端组件库，于 2017 年开源，已持续维护 4 年时间。Vant 对内承载了有赞所有核心业务，对外服务十多万开发者，是业界主流的移动端组件库之一。</p> <h3 id="引入vant"><a href="#引入vant" aria-hidden="true" class="header-anchor">#</a> 引入vant</h3> <div class="language- extra-class"><pre class="language-text"><code>// 安装：
npm install vant -S
</code></pre></div><p>在src创建plugins目录，并创建vant.js，引入vant需要的组件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vant'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Button<span class="token punctuation">)</span>

</code></pre></div><p>在main.js中引入vant.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>
<span class="token keyword">import</span> <span class="token string">'./plugins/vant'</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  router<span class="token punctuation">,</span>
  store<span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token punctuation">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="按需加载"><a href="#按需加载" aria-hidden="true" class="header-anchor">#</a> 按需加载</h3> <p><a href="https://github.com/ant-design/babel-plugin-import" target="_blank" rel="noopener noreferrer">babel-plugin-import<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一款 babel 插件，它会在编译过程中将 import 的写法自动转换为按需引入的方式。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i babel-plugin-import -D
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在.babelrc 中添加配置</span>
<span class="token comment">// 注意：webpack 1 无需设置 libraryDirectory</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;plugins&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;import&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;libraryName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;vant&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;libraryDirectory&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;es&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;style&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 对于使用 babel7 的用户，可以在 babel.config.js 中配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      libraryName<span class="token punctuation">:</span> <span class="token string">'vant'</span><span class="token punctuation">,</span>
      libraryDirectory<span class="token punctuation">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span>
      style<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'vant'</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 接着你可以在代码中直接引入 Vant 组件</span>
<span class="token comment">// 插件会自动将代码转化为方式二中的按需引入形式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vant'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="rem-布局适配"><a href="#rem-布局适配" aria-hidden="true" class="header-anchor">#</a> Rem 布局适配</h3> <p>Vant 中的样式默认使用 <code>px</code> 作为单位，为了移动端适配，这里我们使用<code>rem</code>布局，我们可以使用阿里的js插件 <a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">lib-flexible<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> , 用于设置 rem 基准值 。并修改源码增加刘海屏viewport-fit=cover 适配</p> <p>在<code>public/static/js/</code>下放入<code>flexible.js</code>，</p> <div class="language- extra-class"><pre class="language-text"><code>;(function(win, lib) {
  var doc = win.document
  var docEl = doc.documentElement
  var metaEl = doc.querySelector('meta[name=&quot;viewport&quot;]')
  var flexibleEl = doc.querySelector('meta[name=&quot;flexible&quot;]')
  var dpr = 0
  var scale = 0
  var tid
  var flexible = lib.flexible || (lib.flexible = {})

  if (metaEl) {
    console.warn('将根据已有的meta标签来设置缩放比例')
    var match = metaEl.getAttribute('content').match(/initial\-scale=([\d\.]+)/)
    if (match) {
      scale = parseFloat(match[1])
      dpr = parseInt(1 / scale)
    }
  } else if (flexibleEl) {
    var content = flexibleEl.getAttribute('content')
    if (content) {
      var initialDpr = content.match(/initial\-dpr=([\d\.]+)/)
      var maximumDpr = content.match(/maximum\-dpr=([\d\.]+)/)
      if (initialDpr) {
        dpr = parseFloat(initialDpr[1])
        scale = parseFloat((1 / dpr).toFixed(2))
      }
      if (maximumDpr) {
        dpr = parseFloat(maximumDpr[1])
        scale = parseFloat((1 / dpr).toFixed(2))
      }
    }
  }

  if (!dpr &amp;&amp; !scale) {
    var isAndroid = win.navigator.appVersion.match(/android/gi)
    var isIPhone = win.navigator.appVersion.match(/iphone/gi)
    var devicePixelRatio = win.devicePixelRatio
    if (isIPhone) {
      // iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案
      if (devicePixelRatio &gt;= 3 &amp;&amp; (!dpr || dpr &gt;= 3)) {
        dpr = 3
      } else if (devicePixelRatio &gt;= 2 &amp;&amp; (!dpr || dpr &gt;= 2)) {
        dpr = 2
      } else {
        dpr = 1
      }
    } else {
      // 其他设备下，仍旧使用1倍的方案
      dpr = 1
    }
    scale = 1 / dpr
  }

  docEl.setAttribute('data-dpr', dpr)
  if (!metaEl) {
    metaEl = doc.createElement('meta')
    metaEl.setAttribute('name', 'viewport')
    // 增加刘海屏viewport-fit=cover 适配
    metaEl.setAttribute(
      'content',
      'initial-scale=' +
        scale +
        ', maximum-scale=' +
        scale +
        ', minimum-scale=' +
        scale +
        ', user-scalable=no' +
        ',viewport-fit=cover'
    )
    if (docEl.firstElementChild) {
      docEl.firstElementChild.appendChild(metaEl)
    } else {
      var wrap = doc.createElement('div')
      wrap.appendChild(metaEl)
      doc.write(wrap.innerHTML)
    }
  }

  function refreshRem() {
    var width = docEl.getBoundingClientRect().width
    if (width / dpr &gt; 540) {
      width = 540 * dpr
    }
    var rem = width / 10
    docEl.style.fontSize = rem + 'px'
    flexible.rem = win.rem = rem
  }

  win.addEventListener(
    'resize',
    function() {
      clearTimeout(tid)
      tid = setTimeout(refreshRem, 300)
    },
    false
  )
  win.addEventListener(
    'pageshow',
    function(e) {
      if (e.persisted) {
        clearTimeout(tid)
        tid = setTimeout(refreshRem, 300)
      }
    },
    false
  )

  if (doc.readyState === 'complete') {
    doc.body.style.fontSize = 12 * dpr + 'px'
  } else {
    doc.addEventListener(
      'DOMContentLoaded',
      function(e) {
        doc.body.style.fontSize = 12 * dpr + 'px'
      },
      false
    )
  }

  refreshRem()

  flexible.dpr = win.dpr = dpr
  flexible.refreshRem = refreshRem
  flexible.rem2px = function(d) {
    var val = parseFloat(d) * this.rem
    if (typeof d === 'string' &amp;&amp; d.match(/rem$/)) {
      val += 'px'
    }
    return val
  }
  flexible.px2rem = function(d) {
    var val = parseFloat(d) / this.rem
    if (typeof d === 'string' &amp;&amp; d.match(/px$/)) {
      val += 'rem'
    }
    return val
  }
})(window, window['lib'] || (window['lib'] = {}))

</code></pre></div><p>在<code>public/index.html</code>引入<code>flexible.js</code>文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./static/js/flexible.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>We're sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn't work properly without JavaScript enabled. Please enable it to continue.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- built files will be auto injected --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h3 id="postcss-配置"><a href="#postcss-配置" aria-hidden="true" class="header-anchor">#</a> PostCSS 配置</h3> <p>安装 postcss ：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> postcss-pxtorem -D 
<span class="token function">npm</span> <span class="token function">install</span> px2rem-loader -D
</code></pre></div><p>vue.config.js增加postcss插件：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  publicPath<span class="token punctuation">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>
  css<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// css预设器配置项</span>
    loaderOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      postcss<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-pxtorem'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            rootValue<span class="token punctuation">:</span> <span class="token number">37.5</span><span class="token punctuation">,</span> <span class="token comment">// rem基准值</span>
            unitPrecision<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> 
            propList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="vant安全区适配"><a href="#vant安全区适配" aria-hidden="true" class="header-anchor">#</a> vant安全区适配</h3> <p>iPhone X 等机型底部存在底部指示条，指示条的操作区域与页面底部存在重合，容易导致用户误操作，因此我们需要针对这些机型进行安全区适配。Vant 中部分组件提供了 <code>safe-area-inset-top</code> 或 <code>safe-area-inset-bottom</code> 属性，设置该属性后，即可在对应的机型上开启适配，如下示例：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 在 head 标签中添加 meta 标签，并设置 viewport-fit=cover 值 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
  <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- 开启顶部安全区适配 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-nav-bar</span> <span class="token attr-name">safe-area-inset-top</span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- 开启底部安全区适配 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-number-keyboard</span> <span class="token attr-name">safe-area-inset-bottom</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="自己写安全区适配"><a href="#自己写安全区适配" aria-hidden="true" class="header-anchor">#</a> 自己写安全区适配</h3> <p>Vant 中只有部分组件提供了安全区域属性，所以我们自己写的布局，需要自己进行适配</p> <p><strong>1.设置meta属性,在content下设置关键值 viewport-fit=cover</strong></p> <p>重点是 <code>viewport-fit</code> 这个参数，设置为 <code>cover</code> 表示，内容展示到安全区域外。</p> <blockquote><p>contain: 可视窗口完全包含网页内容</p> <p>cover:  网页内容完全覆盖可视窗口</p> <p>auto: 同contain的作用</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
  <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>以上设置已在上面Rem 布局适配中的<code>flexible.js</code>中进行设置。</p> <p><strong>2.底部固定定位布局判断</strong></p> <p>css中可以通过<code>safe-area-inset-top</code>、<code>safe-area-inset-left</code>、<code>safe-area-inset-right</code>、<code>safe-area-inset-bottom</code>获取四个方向的安全区域，<strong>适配底部则需要用到<code>safe-area-inset-bottom</code></strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">// 设置固定定位,将bottom设置为0
.fixed-layout</span> <span class="token punctuation">{</span>
	<span class="token property">position</span><span class="token punctuation">:</span>fixed<span class="token punctuation">;</span>
	<span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
	<span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
	<span class="token property">right</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
// 判断iphoneX 将 fixed-layout 的 padding-bottom 填充到最底部
<span class="token atrule"><span class="token rule">@supports</span> <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span> or <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
	<span class="token selector">.fixed-layout</span> <span class="token punctuation">{</span>
        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token comment">/* 兜底方案 */</span>
        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 兼容 iOS &lt; 11.2 */</span>
		<span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 兼容 iOS &gt;= 11.2 */</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>注意：</strong><code>constant()</code>是IOS11.2之前的适配版本，11.2以上已经不再支持</p> <p><strong>3.如果页面已经设置过内边距，可以使用<code>calc()</code>函数搞定</strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@supports</span> <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span> or <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
	<span class="token selector">.fixed-layout</span> <span class="token punctuation">{</span>
        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 1.36rem<span class="token punctuation">;</span>
    	<span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>1.36rem + <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>1.36rem + <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>4.写一个安全区域的scss mixins</strong></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">/**
* safe-area 安全区域的混合
* @param $class 类名
* @param $dir 方向 left top bottom right
* @param $value 距离边距的值
*/</span>
<span class="token keyword">@mixin</span> <span class="token function">safe-area</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">,</span> <span class="token property"><span class="token variable">$dir</span></span><span class="token punctuation">:</span> <span class="token string">&quot;bottom&quot;</span><span class="token punctuation">,</span> <span class="token property"><span class="token variable">$value</span></span><span class="token punctuation">:</span> 24px<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token atrule"><span class="token rule">@at-root</span></span> <span class="token punctuation">{</span>
        @supports <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token selector"><span class="token variable">#{$class}</span> </span><span class="token punctuation">{</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token variable">#{$value}</span> <span class="token operator">+</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token property">padding-<span class="token variable">#{$dir}</span></span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token variable">#{$value}</span> <span class="token operator">+</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-<span class="token variable">#{$dir}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用方法</span>
<span class="token comment">// @include safe-area('.fixed-layout', 'left', 24px);</span>
<span class="token comment">// @include safe-area('.fixed-layout', 'top', 24px);</span>
<span class="token comment">// @include safe-area('.fixed-layout', 'bottom', 24px);</span>
<span class="token comment">// @include safe-area('.fixed-layout', 'right', 24px);</span>
</code></pre></div><blockquote><p>在scss中使用calc，如果calc中包含一个变量，不会产生效果 , 要想在scss的calc中使用变量，必须对这个变量使用sass的插值方法(#{$variable})。</p></blockquote> <h3 id="暗黑模式"><a href="#暗黑模式" aria-hidden="true" class="header-anchor">#</a> 暗黑模式</h3> <p><strong>css 方式一：</strong></p> <p>一行css实现暗黑模式</p> <ol><li>通过 <strong>filter</strong> 中的 <strong>invert</strong> 对颜色进行反转</li> <li>对将图片颜色恢复，否则看起来会很怪</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">html</span><span class="token punctuation">{</span>
  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">hue-rotate</span><span class="token punctuation">(</span>180deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">html img</span> <span class="token punctuation">{</span>
  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span> <span class="token function">hue-rotate</span><span class="token punctuation">(</span>180deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>css方式二：</strong></p> <p>通过媒体查询进行设置：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span>dark<span class="token punctuation">)</span></span><span class="token punctuation">{</span>
    // 暗黑模式 你要设置的样式
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span>light<span class="token punctuation">)</span></span><span class="token punctuation">{</span>
    // 你要设置的样式
<span class="token punctuation">}</span>
</code></pre></div><p><strong>js方式：</strong></p> <p>根据下面utils工具库中的 themeModeChange，判断设备模式，然后可以通过回调函数，设置根节点的样式主题：class=&quot;theme-dark&quot;, 然后在css中写样式适配</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// themeModeChange(lightCallback,darkCallback)</span>

<span class="token function">themeModeChange</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'theme-dark'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'theme-dark'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><h2 id="vuex-状态管理"><a href="#vuex-状态管理" aria-hidden="true" class="header-anchor">#</a> Vuex 状态管理</h2> <p>目录：</p> <div class="language- extra-class"><pre class="language-text"><code>├─store
│  │  index.js	
│  │  mutation-types.js		// Mutation 事件类型
│  │
│  └─modules
│          app.js		 // app全局模块
</code></pre></div><h3 id="模块"><a href="#模块" aria-hidden="true" class="header-anchor">#</a> 模块</h3> <p>由于使用单一状态树，应用的所有状态会集中到一个比较大的对象。当应用变得非常复杂时，store 对象就有可能变得相当臃肿。</p> <p>为了解决以上问题，Vuex 允许我们将 store 分割成<strong>模块（module）</strong>。每个模块拥有自己的 state、mutation、action、getter、甚至是嵌套子模块——从上至下进行同样方式的分割：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// store/index.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> app <span class="token keyword">from</span> <span class="token string">'./modules/app'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    app
    <span class="token comment">// 其他模块</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>

<span class="token comment">//Mutation 事件类型</span>
<span class="token keyword">import</span> storage <span class="token keyword">from</span> <span class="token string">'@/libs/storage.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">SET_USER</span><span class="token punctuation">,</span> <span class="token constant">SET_LOADING</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../mutation-types'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启命名空间</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// loading状态</span>
    user<span class="token punctuation">:</span> storage<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span> <span class="token comment">// storage读取本地 user信息</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">SET_USER</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>user <span class="token operator">=</span> user
      storage<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token comment">// storage设置本地 user信息</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">SET_LOADING</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>loading <span class="token operator">=</span> flag
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//   显示loading</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_LOADING</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_USER</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'sayhello'</span><span class="token punctuation">,</span> like<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'篮球'</span><span class="token punctuation">,</span> <span class="token string">'游戏'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">//   隐藏loading</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_LOADING</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="使用常量替代mutation类型"><a href="#使用常量替代mutation类型" aria-hidden="true" class="header-anchor">#</a> 使用常量替代Mutation类型</h3> <p>使用常量替代 mutation 事件类型在各种 Flux 实现中是很常见的模式。这样可以使 linter 之类的工具发挥作用，同时把这些常量放在单独的文件中可以让你的代码合作者对整个 app 包含的 mutation 一目了然：</p> <p><code>mutation-types.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_LOADING</span> <span class="token operator">=</span> <span class="token string">'SET_LOADING'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_USER</span> <span class="token operator">=</span> <span class="token string">'SET_USER'</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用：</span>
<span class="token comment">//Mutation 事件类型</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">SET_USER</span><span class="token punctuation">,</span> <span class="token constant">SET_LOADING</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../mutation-types'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// loading状态</span>
    user<span class="token punctuation">:</span> <span class="token keyword">null</span>	<span class="token comment">// user信息</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">SET_USER</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>user <span class="token operator">=</span> user
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">SET_LOADING</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>loading <span class="token operator">=</span> flag
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="命名空间"><a href="#命名空间" aria-hidden="true" class="header-anchor">#</a> 命名空间</h3> <p>默认情况下，模块内部的 action、mutation 和 getter 是注册在全局命名空间的——这样使得多个模块能够对同一 mutation 或 action 作出响应。</p> <p>为了让模块具有更高的封装度和复用性，我们添加 namespaced: true 的方式使其成为带命名空间的模块。当模块被注册后，它的所有 getter、action 及 mutation 都会自动根据模块注册的路径调整命名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启命名空间</span>
  <span class="token operator">...</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//   显示loading</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_LOADING</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_USER</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'sayhello'</span><span class="token punctuation">,</span> like<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'篮球'</span><span class="token punctuation">,</span> <span class="token string">'游戏'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">//   隐藏loading</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_LOADING</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>开启了命名空间，调用的时候需要加模块名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;home&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>van<span class="token operator">-</span>empty description<span class="token operator">=</span><span class="token string">&quot;您还没有登录~~&quot;</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;!user&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>van<span class="token operator">-</span>button round type<span class="token operator">=</span><span class="token string">&quot;info&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;bottom-button&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;getUser&quot;</span><span class="token operator">&gt;</span> 获取用户信息 <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>empty<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>van<span class="token operator">-</span>contact<span class="token operator">-</span>card v<span class="token operator">-</span><span class="token keyword">else</span> type<span class="token operator">=</span><span class="token string">&quot;edit&quot;</span> <span class="token punctuation">:</span>name<span class="token operator">=</span><span class="token string">&quot;user.name&quot;</span> tel<span class="token operator">=</span><span class="token string">&quot;13000000000&quot;</span> <span class="token punctuation">:</span>editable<span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>


<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapActions<span class="token punctuation">,</span> mapState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">user</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
      <span class="token function-variable function">loading</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>loading
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">loading</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$Toast<span class="token punctuation">.</span><span class="token function">loading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          duration<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          message<span class="token punctuation">:</span> <span class="token string">'加载中...'</span><span class="token punctuation">,</span>
          forbidClick<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$Toast<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cdn'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$cdn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      getUser<span class="token punctuation">:</span> <span class="token string">'app/getUser'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// getUser() {</span>
    <span class="token comment">//   this.$store.dispatch('app/getUser').then(() =&gt; {})</span>
    <span class="token comment">// }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="数据缓存"><a href="#数据缓存" aria-hidden="true" class="header-anchor">#</a> 数据缓存</h3> <p>vue单页面应用，当数据获取后刷新浏览器，存在数据丢失的问题，我们可以在vuex设置数据的时候，将数据存储到localStorage,获取的时候再从localStorage读取。</p> <p>创建<code>libs/storage.js</code></p> <div class="language- extra-class"><pre class="language-text"><code>/**
 * 数据存储
 */
class Storage {
  constructor(options) {
    // 默认配置
    let defaultOptions = {
      nameSpace: '__', // 数据存在命名前缀
      storeType: 'localStorage', // 数据存储类型
      expiresSuffix: '__expires' // 过期时间后缀
    }
    // 合并配置
    this.options = Object.assign({}, defaultOptions, options)
    this.store = window[this.options.storeType]
    this.__init()
  }

  // 检测所有的存储数据是否过期,过期删除
  __init() {
    // 获取storage中的所有keys
    const keys = Object.keys(this.store)
    //
    const reg = new RegExp(this.options.expiresSuffix, 'g')
    if (!keys.length) return false
    keys.map(item =&gt; {
      // 如果存在过期时间
      if (reg.test(item)) {
        // 当前时间
        const now = Date.now()
        // 获取过期时间
        const expires = Number(this.store.getItem(`${item}`) || now + 1)
        // 当前时间大于过期时间，删除数据
        if (now &gt;= expires) {
          let removeKey = item.replace(reg, '')
          this.remove(removeKey)
          return ''
        }
      }
    })
  }

  get(key) {
    key = this.getKey(key)
    const now = Date.now()
    // 过期时间：如果没有过期时间，设置过期时间为当前时间+1，及永远不过期
    const expires = Number(this.store.getItem(`${key}${this.options.expiresSuffix}`) || now + 1)
    if (now &gt;= expires) {
      this.remove(key)
      return ''
    }
    return this.store.getItem(key) ? JSON.parse(this.store.getItem(key)) : null
  }

  /**
   * @param {Object} key
   * @param {Object} value
   * @param {Object} expires 过期时间，按分钟计算
   */
  set(key, value, expires) {
    const now = Date.now()
    key = this.getKey(key)
    value = JSON.stringify(value)
    this.store.setItem(key, value)
    // 设置过期时间:当前时间+过期时间
    if (expires) {
      this.store.setItem(`${key}${this.options.expiresSuffix}`, now + 1000 * 60 * expires)
    }
  }

  remove(key) {
    this.store.removeItem(key)
    this.store.removeItem(`${key}${this.options.expiresSuffix}`)
  }

  getKey(key) {
    return this.options.nameSpace + key
  }
}

export default new Storage({
  nameSpace: process.env.VUE_APP_ENV + '__'
})

</code></pre></div><p><code>store/modules/app.js</code></p> <div class="language- extra-class"><pre class="language-text"><code>//Mutation 事件类型
import storage from '@/libs/storage.js'
import { SET_USER, SET_LOADING } from '../mutation-types'
export default {
  namespaced: true, // 开启命名空间
  state: {
    loading: false, // loading状态
    user: storage.get('user') // storage读取本地 user信息
  },
  mutations: {
    [SET_USER](state, user) {
      state.user = user
      storage.set('user', user) 
    },
    [SET_LOADING](state, flag) {
      state.loading = flag
    }
  },
  actions: {
    getUser({ commit }) {
      return new Promise(resolve =&gt; {
        //   显示loading
        commit(SET_LOADING, true)
        setTimeout(() =&gt; {
          commit(SET_USER, { name: 'sayhello', like: ['篮球', '游戏'] })
          //   隐藏loading
          commit(SET_LOADING, false)
          resolve()
        }, 2000)
      })
    }
  }
}

</code></pre></div><h2 id="vuerouter设置"><a href="#vuerouter设置" aria-hidden="true" class="header-anchor">#</a> VueRouter设置</h2> <h3 id="记录tabbar浏览的位置"><a href="#记录tabbar浏览的位置" aria-hidden="true" class="header-anchor">#</a> 记录tabbar浏览的位置</h3> <p>为了优化体验，保持与app同样的缓存页面效果，切换的时候跳转到对应的浏览记录,需要在页面中定义子路由的地方，添加<code>keep-alive</code>,并且tabbar切换的时候，需要采用<code>$router.replace()</code>进行替换，然后我们还需要在router/index.js中,<code>router.beforeEach</code>里面获取滚动的位置，存储到pageScroll中，再通过<code>scrollBehavior</code>设置滚动的位置。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 记录页面滚动值</span>
<span class="token keyword">let</span> pageScroll <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 假如路由的tabbar定义</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    redirect<span class="token punctuation">:</span> <span class="token string">'/today'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> mainLayout<span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'today'</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token string">'Today'</span><span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> Today
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'week'</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token string">'Week'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;week&quot; */</span> <span class="token string">'../views/week'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'month'</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token string">'Month'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;month&quot; */</span> <span class="token string">'../views/month'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'hash'</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
  <span class="token function">scrollBehavior</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> savedPosition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>savedPosition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> savedPosition
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果当前界面存在滚动值，就跳转到滚动位置</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>pageScroll<span class="token punctuation">[</span>to<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> pageScroll<span class="token punctuation">[</span>to<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 不存在，回到顶部</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// tabbar的根路由名称</span>
  <span class="token keyword">let</span> tabbars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Home'</span><span class="token punctuation">]</span>
  <span class="token comment">// from的路由名</span>
  <span class="token keyword">let</span> formName <span class="token operator">=</span> <span class="token keyword">from</span><span class="token punctuation">.</span>name
  <span class="token comment">// 判断子路由的父级是否为tabbar的根路由（这里根据情况而定）</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> tabbars<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 记录滚动值</span>
    <span class="token keyword">let</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop
    <span class="token keyword">if</span> <span class="token punctuation">(</span>formName <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>scrollTop<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pageScroll<span class="token punctuation">[</span>formName<span class="token punctuation">]</span> <span class="token operator">=</span> scrollTop
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="配置-externals-引入-cdn-资源"><a href="#配置-externals-引入-cdn-资源" aria-hidden="true" class="header-anchor">#</a> 配置 externals 引入 cdn 资源</h2> <p>在<code>env.base.js</code>增加cdn配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span>
  <span class="token comment">/**
   * 是否使用cdn
   */</span>
  useCdn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * cdn 的资源链接
   */</span>
  cdn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    js<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.min.js'</span><span class="token punctuation">,</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/vue-router@3.4.9/dist/vue-router.min.js'</span><span class="token punctuation">,</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/axios@0.19.2/dist/axios.min.js'</span><span class="token punctuation">,</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/vuex@3.1.2/dist/vuex.min.js'</span><span class="token punctuation">,</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/echarts@4.9.0/dist/echarts.min.js'</span><span class="token punctuation">,</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/vconsole@3.3.4/dist/vconsole.min.js'</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>在<code>env.production.js</code>增加cdn配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 是否使用cdn
   */</span>
  useCdn<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre></div><p>修改vue.config.js配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入配置文件</span>
<span class="token keyword">const</span> myConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/config/index'</span><span class="token punctuation">)</span>
<span class="token comment">// 需要使用cdn的外部环境包</span>
<span class="token keyword">const</span> externals <span class="token operator">=</span> <span class="token punctuation">{</span>
  vue<span class="token punctuation">:</span> <span class="token string">'Vue'</span><span class="token punctuation">,</span>
  <span class="token string">'vue-router'</span><span class="token punctuation">:</span> <span class="token string">'VueRouter'</span><span class="token punctuation">,</span>
  vuex<span class="token punctuation">:</span> <span class="token string">'Vuex'</span><span class="token punctuation">,</span>
  axios<span class="token punctuation">:</span> <span class="token string">'axios'</span><span class="token punctuation">,</span>
  echarts<span class="token punctuation">:</span> <span class="token string">'echarts'</span><span class="token punctuation">,</span>
  <span class="token string">'vue-echarts'</span><span class="token punctuation">:</span> <span class="token string">'VueECharts'</span><span class="token punctuation">,</span>
    vconsole<span class="token punctuation">:</span> <span class="token string">'VConsole'</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token function-variable function">configureWebpack</span><span class="token punctuation">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>myConfig<span class="token punctuation">.</span>useCdn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// externals 外部环境</span>
      config<span class="token punctuation">.</span>externals <span class="token operator">=</span> externals
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 对内部的 webpack 配置进行修改</span>
  <span class="token function-variable function">chainWebpack</span><span class="token punctuation">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">args</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 修改网页标题</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">=</span> myConfig<span class="token punctuation">.</span>appTitle
      <span class="token comment">// 配置cdn是否使用</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>useCdn <span class="token operator">=</span> myConfig<span class="token punctuation">.</span>useCdn
      <span class="token comment">// 配置cdn</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn <span class="token operator">=</span> myConfig<span class="token punctuation">.</span>cdn
      <span class="token keyword">return</span> args
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><p>修改index.html,循环插入cdn资源</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./static/js/flexible.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  
  
  <span class="token comment">&lt;!-- 使用CDN加速的css文件，配置在config/index.js下 --&gt;</span>
  &lt;% for (var i in
      htmlWebpackPlugin.options.useCdn&amp;&amp;htmlWebpackPlugin.options.cdn.css) { %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>style<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  &lt;% } %&gt;
  <span class="token comment">&lt;!-- 使用CDN加速的JS文件，配置在config/index.js下 --&gt;</span>
  &lt;% for (var i in
      htmlWebpackPlugin.options.useCdn&amp;&amp;htmlWebpackPlugin.options.cdn.js) { %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  &lt;% } %&gt;
  
  
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>We're sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn't work properly without JavaScript enabled.
      Please enable it to continue.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- built files will be auto injected --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>经过分析比对，当资源很大的时候采用cdn才会更快，比较小的资源还是采用内嵌引入。</p> <h2 id="去掉console-log"><a href="#去掉console-log" aria-hidden="true" class="header-anchor">#</a> 去掉console.log</h2> <p><a href="https://www.npmjs.com/package/babel-plugin-transform-remove-console" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>使用babel插件去掉console.log</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> -D babel-plugin-transform-remove-console
</code></pre></div><p><code>config/env.base.js</code> 设置console配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 移除console的配置
   */</span>
  removeConsole<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  consoleOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span> exclude<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'warn'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>config/env.production.js</code> 生产环境配置移除console配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span>
  <span class="token comment">/**
   * 移除console的配置
   */</span>
  removeConsole<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>babel.config.js</code> console的配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/config/index'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token string">'import'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      libraryName<span class="token punctuation">:</span> <span class="token string">'vant'</span><span class="token punctuation">,</span>
      libraryDirectory<span class="token punctuation">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span>
      style<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'vant'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token comment">// 移除console</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>myConfig<span class="token punctuation">.</span>removeConsole<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'transform-remove-console'</span><span class="token punctuation">,</span> myConfig<span class="token punctuation">.</span>consoleOptions<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> plugins
<span class="token punctuation">}</span>

</code></pre></div><h2 id="gzip压缩"><a href="#gzip压缩" aria-hidden="true" class="header-anchor">#</a> Gzip压缩</h2> <p>启用 gzip 压缩可大幅缩减传输资源大小，从而缩短资源下载时间，减少首次白屏时间，提升用户体验。</p> <p><a href="https://www.npmjs.com/package/compression-webpack-plugin" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> compression-webpack-plugin --save-dev
</code></pre></div><p><code>vue.config.js</code>配置gzip</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入配置文件</span>
<span class="token keyword">const</span> myConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/config/index'</span><span class="token punctuation">)</span>
<span class="token comment">// gizp压缩插件</span>
<span class="token keyword">const</span> CompressionPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'compression-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token function-variable function">configureWebpack</span><span class="token punctuation">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">// gzip压缩插件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>myConfig<span class="token punctuation">.</span>useGzip<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          test<span class="token punctuation">:</span> <span class="token regex">/\.js$|\.html$|\.css/</span><span class="token punctuation">,</span> <span class="token comment">// 匹配文件名</span>
          threshold<span class="token punctuation">:</span> <span class="token number">10240</span><span class="token punctuation">,</span> <span class="token comment">// 对超过10kb的数据进行压缩</span>
          deleteOriginalAssets<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token comment">// 是否删除原文件</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="webpack-可视化分析"><a href="#webpack-可视化分析" aria-hidden="true" class="header-anchor">#</a> webpack 可视化分析</h2> <p>从这里开始，我们开始进行 webpack 优化打包。首先我们来分析一下 webpack 打包性能瓶颈，找出问题所在，然后才能对症下药。此时就用到 webpack-bundle-analyzer 了。</p> <p>1、安装依赖</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> webpack-bundle-analyzer -D
</code></pre></div><p>2、在config中添加配置项openAnalyzer，不同环境显示不同设置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// env.base.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 是否开启可视化分析
   */</span>
  useAnalyzer<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>



<span class="token comment">// env.production.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 是否开启可视化分析
   */</span>
  useAnalyzer<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre></div><p>3、在 vue.config.js 配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入配置文件</span>
<span class="token keyword">const</span> myConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/config/index'</span><span class="token punctuation">)</span>
<span class="token comment">// 打包分析插件</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> BundleAnalyzerPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span>
<span class="token function-variable function">configureWebpack</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>
  	<span class="token comment">// 如果openAnalyzer为true,进行打包分析</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>myConfig<span class="token punctuation">.</span>useAnalyzer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'webpack-report'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>BundleAnalyzerPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          analyzerMode<span class="token punctuation">:</span> <span class="token string">'static'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="首页添加骨架屏"><a href="#首页添加骨架屏" aria-hidden="true" class="header-anchor">#</a> 首页添加骨架屏</h2> <p>使用插件<code>page2-skeleton-webpack-plugin</code>自动添加骨架屏  <a href="https://gitee.com/zhufengpeixun/page2-skeleton-webpack-plugin/blob/master/docs/i18n/zh_cn.md" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> page2-skeleton-webpack-plugin -D
</code></pre></div><p>在vue.config.js配置骨架屏参数</p> <div class="language- extra-class"><pre class="language-text"><code>// 引入配置文件
const myConfig = require('./src/config/index')
// 骨架屏
const { SkeletonPlugin } = require('page2-skeleton-webpack-plugin')
const { resolve } = require('path')

module.exports = {
  publicPath: './',
  configureWebpack: config =&gt; {
  ...
    // Skeleton压缩插件
    if (myConfig.useSkeleton) {
      config.plugins.push(
        new SkeletonPlugin({
          pathname: resolve(__dirname, `./shell`), // 用来存储 shell 文件的地址
          staticDir: resolve(__dirname, './dist'), // 最好和 `output.path` 相同
          routes: ['/'], // 将需要生成骨架屏的路由添加到数组中
          port: '7890',
          loading: 'chiaroscuro',
          cssUnit: 'rem',// rem
          headless: true // 无头浏览器
        })
      )
    }
  },
 ...
}

</code></pre></div><p>运行项目，在控制台输入<code>toggleBar</code>,在浏览器页面顶部会出现打开按骨架屏页面的按钮</p> <p>点击按钮进入界面，调整样式，</p> <p>最后将右侧的骨架屏代码复制到dist/index.html中。</p> <h3 id="puppeteer安装问题"><a href="#puppeteer安装问题" aria-hidden="true" class="header-anchor">#</a> Puppeteer安装问题</h3> <p>1、骨架屏插件依赖于puppeteer</p> <div class="language-sh extra-class"><pre class="language-sh"><code>// 安装Puppeteer会下载chromium失败
Failed to download Chromium

<span class="token comment"># or</span>

Cannot <span class="token builtin class-name">read</span> property <span class="token string">'newPage'</span> of null
</code></pre></div><p>出现这2个错误的原因是由于安装Puppeteer(一个Node库，它提供了一个高级API来控制DevTools协议上的Chrome或Chromium)时，会自动下载最新版本的Chromium。但是由于该网站被墙，所以 就下载不成功了。我们可以设置环境变量来阻止下载</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">set</span> <span class="token assign-left variable">PUPPETEER_SKIP_CHROMIUM_DOWNLOAD</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><p>2、查看Puppeteer的package.json中的chromium_revision版本号</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;puppeteer&quot;: {
    &quot;chromium_revision&quot;: &quot;686378&quot;
  },
</code></pre></div><p>3、去淘宝源下载对应版本号的chromium ：<a href="https://npm.taobao.org/mirrors/chromium-browser-snapshots/" target="_blank" rel="noopener noreferrer"> https://npm.taobao.org/mirrors/chromium-browser-snapshots/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>4、将下载的chromium 解压到</p> <div class="language- extra-class"><pre class="language-text"><code>puppeteer\.local-chromium\win64-{{对应版本-chromium_revision}}
// 例如
D:\project\vue-mobile\node_modules\puppeteer\.local-chromium\win64-686378
</code></pre></div><p>5、再次运行即可成功！</p> <h2 id="常用工具函数"><a href="#常用工具函数" aria-hidden="true" class="header-anchor">#</a> 常用工具函数</h2> <h3 id="echarts适配"><a href="#echarts适配" aria-hidden="true" class="header-anchor">#</a> echarts适配</h3> <p>在rem布局中，echarts中的字体,内部标签等宽高，偏移，间距进行适配</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * chart设置字体大小
 * @param {*} fs 字体大小
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">adapterChart</span> <span class="token operator">=</span> <span class="token parameter">fs</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token comment">//获取到屏幕的宽度</span>
  <span class="token keyword">var</span> clientWidth <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">||</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>clientWidth<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">//报错拦截：</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>clientWidth <span class="token operator">&gt;</span> <span class="token number">540</span><span class="token punctuation">)</span> clientWidth <span class="token operator">=</span> <span class="token number">540</span>
  <span class="token keyword">let</span> fontSize <span class="token operator">=</span> clientWidth <span class="token operator">/</span> <span class="token number">375</span>
  <span class="token keyword">let</span> dpr <span class="token operator">=</span> window<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>flexible<span class="token punctuation">.</span>dpr <span class="token operator">||</span> <span class="token number">1</span>
  <span class="token comment">// 3倍屏显示已2进行处理</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dpr <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dpr <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token comment">// 2 已1进行处理</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dpr <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dpr <span class="token operator">=</span> <span class="token number">1.5</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    dpr <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> fs <span class="token operator">*</span> fontSize <span class="token operator">*</span> dpr
<span class="token punctuation">}</span>

<span class="token comment">// 例如：</span>
<span class="token comment">// fontSize: adapterChart(12),</span>
<span class="token comment">// lineHeight: adapterChart(24),</span>
<span class="token comment">// offset: [adapterChart(24)],</span>

</code></pre></div><h3 id="截取字符串并加省略号"><a href="#截取字符串并加省略号" aria-hidden="true" class="header-anchor">#</a> 截取字符串并加省略号</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 *  截取字符串并加省略号
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">subText</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'...'</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="数组数字去重"><a href="#数组数字去重" aria-hidden="true" class="header-anchor">#</a> 数组数字去重</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 数组去重
 * @param {*} arr
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token parameter">arr</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//Set数据结构，它类似于数组，其成员的值都是唯一的</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 利用Array.from将Set结构转换成数组</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="日期格式替换"><a href="#日期格式替换" aria-hidden="true" class="header-anchor">#</a> 日期格式替换</h3> <p>ios日期不支持2020-10-10这种格式</p> <p>将日期 2020-10-10 替换为2020/10/10</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 将日期 2020-10-10 替换为2020/10/10
 * @param {*} date
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">dateReplace</span> <span class="token operator">=</span> <span class="token parameter">date</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> date<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="延迟执行"><a href="#延迟执行" aria-hidden="true" class="header-anchor">#</a> 延迟执行</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 延迟执行
 * @param {*} time
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token parameter">time</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="冒泡排序"><a href="#冒泡排序" aria-hidden="true" class="header-anchor">#</a> 冒泡排序</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 冒泡排序
 * @description 以字段[name]进行排序
 * @param {*} data 数据
 * @param {*} name 排序的字段
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">bSort</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>data<span class="token punctuation">]</span>
  <span class="token keyword">var</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 相邻元素两两对比，元素交换，大的元素交换到后面</span>
       <span class="token keyword">let</span> current<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
       <span class="token keyword">let</span> next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	current <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">0</span>
      	next <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
     	current <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
      	next <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&gt;</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
        arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</code></pre></div><h3 id="设备颜色模式"><a href="#设备颜色模式" aria-hidden="true" class="header-anchor">#</a> 设备颜色模式</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">/**
 * 判断主题模式为深色或浅色
 * @param {*} lightCallback 浅色模式回调
 * @param {*} darkCallback 深色模式回调
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">themeModeChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">lightCallback<span class="token punctuation">,</span> darkCallback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mediaQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(prefers-color-scheme: dark)'</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">darkModeHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaQuery<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      darkCallback <span class="token operator">&amp;&amp;</span> <span class="token function">darkCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      lightCallback <span class="token operator">&amp;&amp;</span> <span class="token function">lightCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 判断当前模式</span>
  <span class="token function">darkModeHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 监听模式变化</span>
  mediaQuery<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>darkModeHandler<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="开发遇到的问题"><a href="#开发遇到的问题" aria-hidden="true" class="header-anchor">#</a> 开发遇到的问题</h2> <h3 id="echarts"><a href="#echarts" aria-hidden="true" class="header-anchor">#</a> echarts</h3> <h4 id="x-y轴部分label不显示"><a href="#x-y轴部分label不显示" aria-hidden="true" class="header-anchor">#</a> x,y轴部分label不显示</h4> <p>x,y轴部分标签文字过长，导致部分标签不显示，我们可以通过设置</p> <div class="language-js extra-class"><pre class="language-js"><code>axisLabel<span class="token punctuation">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 是否显示最小 tick 的 label，默认自动判断，导致某些标签不显示</span>
	showMinLabel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token comment">// 是否显示最大 tick</span>
    showMaxLabel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 0 显示所有标签  1-间隔显示标签</span>
    interval<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token comment">// 格式化label,换成多行显示</span>
	<span class="token function-variable function">formatter</span><span class="token punctuation">:</span> <span class="token parameter">label</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>label<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> label<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> label<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'...'</span>
       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>label<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> label<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> label<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> label
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="vue-echarts使用cdn打包后，报错"><a href="#vue-echarts使用cdn打包后，报错" aria-hidden="true" class="header-anchor">#</a> vue-echarts使用cdn打包后，报错</h4> <div class="language-js extra-class"><pre class="language-js"><code>Error<span class="token punctuation">:</span> Component series<span class="token punctuation">.</span>line not exists<span class="token punctuation">.</span> Load it first<span class="token punctuation">.</span>
</code></pre></div><p>是由于在vue.config.js中externals外部环境包名不对引起的，</p> <p>打开<a href="https://cdn.bootcdn.net/ajax/libs/echarts/4.1.0/echarts.min.js" target="_blank" rel="noopener noreferrer">ECharts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和<a href="https://cdn.bootcdn.net/ajax/libs/vue-echarts/4.0.2/vue-echarts.min.js" target="_blank" rel="noopener noreferrer">Vue-ECharts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的CDN，找到对外暴露给浏览器使用的包名，分别为echarts和VueECharts</p> <div class="language- extra-class"><pre class="language-text"><code>// 需要使用cdn的外部环境包
const externals = {
  vue: 'Vue',
  'vue-router': 'VueRouter',
  vuex: 'Vuex',
  axios: 'axios',
  echarts: 'echarts',
  'vue-echarts': 'VueECharts'
}
</code></pre></div><p>在main.js或其他地方引入使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> echarts <span class="token keyword">from</span> <span class="token string">'echarts'</span>
<span class="token keyword">import</span> VueECharts <span class="token keyword">from</span> <span class="token string">'vue-echarts'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'v-chart'</span><span class="token punctuation">,</span> VueECharts<span class="token punctuation">)</span>
</code></pre></div><h4 id="vue-echarts，页面keep-alive切换后，图表不显示"><a href="#vue-echarts，页面keep-alive切换后，图表不显示" aria-hidden="true" class="header-anchor">#</a> vue-echarts，页面keep-alive切换后，图表不显示</h4> <p>由于在v-chart中增加了 autoresize  =“true”,并且页面增加了keep-alive缓存，导致页面切换，图表第二次不渲染，</p> <p><strong>解决办法：</strong></p> <p>去掉autoresize,增加手动resize</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>v<span class="token operator">-</span>chart ref<span class="token operator">=</span><span class="token string">&quot;chart&quot;</span> <span class="token punctuation">:</span>manual<span class="token operator">-</span>update<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>v<span class="token operator">-</span>chart<span class="token operator">&gt;</span>


 <span class="token comment">// 合并配置项</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>chart<span class="token punctuation">.</span><span class="token function">mergeOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 手动重置resize</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>chart<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/23/2020, 9:59:45 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.ee223f02.js" defer></script><script src="/blog/assets/js/2.f364336e.js" defer></script><script src="/blog/assets/js/14.25b3510a.js" defer></script>
  </body>
</html>
